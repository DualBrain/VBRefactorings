<?xml version="1.0" encoding="utf-8"?>
<Project>
    <Import Sdk="Microsoft.NET.Sdk" Project="Sdk.props" />
    <PropertyGroup>
        <TargetFramework>net472</TargetFramework>
        <MinimumVisualStudioVersion>16.0</MinimumVisualStudioVersion>
        <RootNamespace>VBRefactorings.Vsix</RootNamespace>
        <AssemblyName>VBRefactoringsVsix</AssemblyName>
        <OptionExplicit>On</OptionExplicit>
        <OptionCompare>Binary</OptionCompare>
        <AutoGenerateBindingRedirects>true</AutoGenerateBindingRedirects>
            <AutoGenerateBindingRedirects>true</AutoGenerateBindingRedirects>
</PropertyGroup>
    <PropertyGroup>
        <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
        <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
        <SchemaVersion>2.0</SchemaVersion>
        <ProjectTypeGuids>{82b43b9b-a64c-4715-b499-d71e9ca2bd60};{F184B08F-C81C-45F6-A57F-5ABD9991F28F}</ProjectTypeGuids>
        <ProjectGuid>{8476D0F4-C545-459B-A527-234561D94998}</ProjectGuid>
        <OutputType>Library</OutputType>
        <RootNamespace>VSIXProject1</RootNamespace>
        <AssemblyName>VSIXProject1</AssemblyName>
        <GeneratePkgDefFile>false</GeneratePkgDefFile>
        <GenerateAssemblyInfo>false</GenerateAssemblyInfo>
        <IncludeAssemblyInVSIXContainer>false</IncludeAssemblyInVSIXContainer>
        <IncludeDebugSymbolsInVSIXContainer>false</IncludeDebugSymbolsInVSIXContainer>
        <IncludeDebugSymbolsInLocalVSIXDeployment>false</IncludeDebugSymbolsInLocalVSIXDeployment>
        <CopyBuildOutputToOutputDirectory>false</CopyBuildOutputToOutputDirectory>
        <CopyOutputSymbolsToOutputDirectory>false</CopyOutputSymbolsToOutputDirectory>
        <OptionStrict>Off</OptionStrict>
        <OptionInfer>On</OptionInfer>
        <StartAction>Program</StartAction>
        <StartProgram Condition="'$(DevEnvDir)' != ''">$(DevEnvDir)devenv.exe</StartProgram>
        <StartArguments>/rootsuffix Roslyn</StartArguments>
        <VSSDKTargetPlatformRegRootSuffix>Roslyn</VSSDKTargetPlatformRegRootSuffix>
        <PackageId>VBRefactorings</PackageId>
        <Version>2.5</Version>
        <Authors>Paul Cohen</Authors>
        <Company>Travel By Paul</Company>
        <Product>VBRefactorings</Product>
        <AutoGenerateBindingRedirects>true</AutoGenerateBindingRedirects>
    </PropertyGroup>

    <Import Sdk="Microsoft.NET.Sdk" Project="Sdk.targets" />
    <ItemGroup>
        <None Include="source.extension.vsixmanifest">
            <SubType>Designer</SubType>
        </None>
    </ItemGroup>

    <ItemGroup>
        <!-- https://github.com/dotnet/sdk/issues/433 -->
        <ProjectReference Update="@(ProjectReference)" AdditionalProperties="TargetFramework=net452" />

        <!-- https://github.com/Microsoft/extendvs/issues/57 -->
        <ProjectReference Update="@(ProjectReference)" Name="%(Filename)" />
    </ItemGroup>

    <ItemGroup>
        <PackageReference Include="Microsoft.VisualStudio.SDK" Version="16.0.206" ExcludeAssets="runtime">
            <IncludeAssets>compile; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>
        </PackageReference>
        <PackageReference Include="Microsoft.VSSDK.BuildTools" Version="16.7.2046" />
    </ItemGroup>

    <ItemGroup>
      <ProjectReference Include="..\VBRefactorings\VBRefactorings.vbproj" />
    </ItemGroup>
</Project>
